{"version":3,"sources":["personal_website/views/search_html.cljs"],"mappings":"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","names":["personal-website.views.search-html/posts","cljs.core/flatten","personal-website.content.projects.projects/posts","personal-website.content.writings.writings/posts","personal-website.content.readings.readings/posts","personal-website.views.search-html/post-mapping","cljs.core.into","iter__4529__auto__","s__31716","cljs.core/LazySeq","temp__5735__auto__","cljs.core/seq","cljs.core/chunked-seq?","c__4527__auto__","size__4528__auto__","cljs.core/count","b__31718","cljs.core/chunk-buffer","i__31717","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__31715","cljs.core/chunk-rest","cljs.core/first","cljs.core/cons","cljs.core/rest","post","personal-website.views.search-html/format-objs","objs","p1__31719#","cljs.core.map","cljs.core.update_in","cljs.core.partial","clojure.string/join","cljs.core/clj->js","personal-website.views.search-html/searcher","this","seq__31720","chunk__31721","count__31722","i__31723","c__4556__auto__","cljs.core/chunk-first","cljs.core/next","obj","personal-website.views.search-html/search","query","search-fn","js/module$node_modules$lunr$lunr","results","formatted","cljs.core.js__GT_clj","s__31725","b__31727","i__31726","iter__31724","G__31728","G__31729","cljs.core/deref","p1__31730#","personal-website.views.search-html/search-field","re_frame.core.subscribe","re-frame.core/dispatch","personal-website.views.search-html/search-results","cljs.core._EQ_","cljs.core.not_EQ_","personal-website.views.preview-html/preview","personal-website.views.search-html/search-html"],"sourcesContent":["(ns personal-website.views.search-html\n  (:require [\"lunr\" :as lunr]\n            [re-frame.core :as re-frame]\n            [personal-website.content.projects.projects :as projects]\n            [personal-website.content.writings.writings :as writings]\n            [personal-website.content.readings.readings :as readings]\n            [personal-website.views.preview-html :refer [preview]]\n            [clojure.set :as set]\n            [clojure.string :refer [join]]))\n\n\n(def posts (flatten [projects/posts\n                     writings/posts\n                     readings/posts]))\n\n(def post-mapping (into {} (for [post posts]\n                        [(post :title) post])))\n\n\n(defn format-objs [objs]\n  (->> objs\n       (map #(update-in % [:tags] (partial join \", \")) objs)\n       (map clj->js)\n       (into [])))\n\n\n(defn searcher []\n  (let [objs (clj->js (format-objs posts))]\n    (this-as this\n             (.ref this \"title\")\n             (.field this \"title\")\n             (.field this \"content\")\n             (.field this \"type\")\n             (.field this \"tags\")\n             (.field this \"overarching\")\n             (doseq [obj objs]\n               (.add this obj)))))\n\n\n(defn search [query]\n  (let [search-fn (lunr searcher)\n        results (.search search-fn query)\n\n        formatted (js->clj results)]\n    (for [post formatted]\n      (post-mapping (post \"ref\")))))\n\n\n(defn search-field []\n  [:input {:id \"search-view\"\n           :type \"text\"\n           :placeholder \"Search for content...\"\n           :value @(re-frame/subscribe [:homepage/search-term])\n           :on-change #(re-frame/dispatch [:homepage/search-term (-> % .-target .-value)])\n           }])\n\n(defn search-results []\n  (let [query @(re-frame/subscribe [:homepage/search-term])\n        results (search (if (or (= query nil) (= query \"\"))\n                          \"12345678987654321\" query))]\n    [:div {:id \"search-results\"}\n     [:div {:id \"search-count\"} (str (count results) \" Result(s) Found.\")]\n     (if (not= (count results) 0)\n      [:div {:id \"results-container\"\n             :style {:margin-right \"10px\"}} (map preview results)]\n       [:div])]))\n\n(defn search-html []\n  [:div {:id \"search-container\"}\n   (search-field)\n   (search-results)])\n"]}